var txtHeight,lrcHeight,tcMode,tcFrom,tcTo,keycode_F1=112,keycode_F2=113,keycode_F3=114,keycode_F4=115,keycode_F5=116,keycode_F6=117,keycode_F7=118,keycode_F8=119,keycode_F9=120,keycode_F10=121,keycode_F11=122,keycode_F12=123,_keycode=0,is_editWin_show=!1,is_txt_show=!1,is_lrc_show=!1,playtcTimer=0,tcIndex=0,tcLength=0,cntR_tc=3,is_R_tc=!1,nowShow="lrc",timer_R_tc=0,Player={obja:null,objv:null,obj:null,state:0,state2:0,is_playing:!1,is_X_moving:!1,rate:1,rate0:1,ratemin:.5,ratemax:3,R_time_wait:0,R_time_wait_drag:0,is_bntP_down:!1,is_btnP_moving:!1,r_cnt0:0,r_cnt:0,r_cnt_tmp:0,r_cnt_now:0,R_time:5,is_R:!1,is_R_stop:!1,is_R_tc:!1,is_btnR_down:!1,is_btnR_moving:!1,timer_R:-1,dotA:0,dotA_old:0,dotA_wy:0,is_A:!1,is_btnA_down:!1,is_btnA_moving:!1,dotB:0,dotB_old:0,dotB_wy:0,is_B:!1,is_btnB_down:!1,is_btnB_moving:!1,is_labelA_show:!1,is_labelB_show:!1,labelA_x:0,labelB_x:0,play_list:[],current_index:-1,is_mp3:!1,is_mp4:!1,is_slider_dragging:!1,is_touch:!1,is_single:!1,is_single_loop:!1,is_multi_loop:!0,is_sync:!1,syncTimer:0,btnBorderColor:"",clear_list:function(){this.play_list.length=0,this.current_index=-1},is_empty_play_list:function(){return 0==this.play_list.length},setobj:function(e){this.obj=document.getElementById(e)},sync:function(e){},ch:function(){var e=$("#playerblock"),t=$("#playerwrap");return setInterval((function(){e.height(t.outerHeight())}),500)},setPlayerRate:function(e){Player.rate=e,$("#btnX").text(e)},play:function(){0==arguments.length&&(this.obj.play(),this.obj.playbackRate=Player.rate),this.state=1,this.state2=1,$("#btnPlay").css("background-image","url(/webr8/img/pause.png)")},playAB:function(){this.pause(),this.startplayAB(),this.is_R=!0,this.btnR_on()},startplayAB:function(){Player.obj.currentTime=Player.dotA,clearInterval(Player.timer_R),Player.listeningAB(),Player.play()},listeningAB:function(){var e=!1;Player.timer_R=setInterval((function(){e||($("#btnR").text(Player.r_cnt>0?Player.r_cnt_now+1+"/"+Player.r_cnt0:""),e=!0),Player.is_R_stop?(clearInterval(Player.timer_R),Player.is_R_stop=!1,Player.is_R=!1,Player.btnR_off(),$("#btnR").text(Player.r_cnt>0?Player.r_cnt:"")):Player.obj.currentTime>Player.dotB&&(0!=Player.r_cnt0&&(Player.r_cnt_now++,e=!1),Player.r_cnt_now>=Player.r_cnt&&Player.r_cnt0?(Player.cancelAB(),Player.is_R_stop=!0,Player.r_cnt_now=0):(Player.pause(),Player.obj.currentTime=Player.dotB,clearInterval(Player.timer_R),setTimeout(Player.startplayAB,Player.R_time_wait)))}),100)},cancelAB:function(){this.is_R_stop=!0},pause:function(){0==arguments.length&&this.obj.pause(),this.state=2,$("#btnPlay").css("background-image","url(/webr8/img/play.png)")},stop:function(){Player.obj.currentTime=0,Player.obj.pause(),Player.state=0,Player.state2=0,$("#slider-play").width(0),$("#btnPlay").css("background-image","url(/webr8/img/play.png)"),lrc&&(clearTCTimer(!0),this.obj.playbackRate=this.rate,$("#btnR").text(Player.r_cnt0?Player.r_cnt0:""))},btnR_on:function(){$("#btnR").css("background-color","#ffee00")},btnR_off:function(){$("#btnR").css("background-color","")},btnA_on:function(){$("#btnA").css("background-color","#ffea00"),this.is_A=!0},btnA_off:function(){$("#btnA").css("background-color","#f1f1f1"),this.is_A=!1},btnB_on:function(){$("#btnB").css("background-color","#ffea00"),this.is_B=!0},btnB_off:function(){$("#btnB").css("background-color","#f1f1f1"),this.is_B=!1},btnPlay_click:function(){0==Player.state||2==Player.state?(Player.play(),Player.state2=1):1==Player.state&&(Player.pause(),Player.state2=2)},btnStop_click:function(){this.btnC_click(),Player.stop(),Player.state2=2,clearTCTimer(!0)},btnBf_click:function(e){var t;(t=e.ctrlKey?Player.obj.currentTime-10:Player.obj.currentTime-3)<0&&(t=0),Player.obj.currentTime=t},btnBf_longclick:function(){if(Player.is_labelA_show&&Player.is_labelB_show){var e,t=Player.dotA,n=Player.dotB-t;Player.dotB=t,(e=t-n)<0&&(e=0),Player.dotA=e,Player.labelA_set(e),Player.labelB_set(t)}},btnFf_click:function(e){var t;(t=e.ctrlKey?Player.obj.currentTime+10:Player.obj.currentTime+3)>Player.obj.duration&&(t=Player.obj.duration),Player.obj.currentTime=t},btnFf_longclick:function(){if(Player.is_labelA_show&&Player.is_labelB_show){var e,t=Player.dotB,n=t-Player.dotA;Player.dotA=t,(e=t+n)>Player.obj.duration&&(e=Player.obj.duration),Player.dotB=e,Player.labelA_set(t),Player.labelB_set(e)}},btnP_click:function(e){Player.R_time_wait=0,$("#btnP").text(Player.R_time_wait>0?x:"")},btnR_click:function(e){if(this.is_R)Player.cancelAB();else{var t=Player.obj.currentTime;t<.5&&(t=Player.obj.currentTime=.5),Player.btnC_click(),this.btnB_set(t),(t-=Player.R_time)<0&&(t=0),this.btnA_set(t),clearTCTimer()}},btnR_dragging:function(e){e.preventDefault();e.pageX,e.pageY},btnA_click:function(e){Player.btnA_set(Player.obj.currentTime)},btnA_set:function(e){Player.labelA_set(e),Player.is_labelB_show&&(checkAB(),Player.playAB())},labelA_set:function(e){Player.dotA=e;var t=Player.labelA_x=e/Player.obj.duration*Player.sliderWidth();$("#lblA").css("left",t),Player.lblA_show()},btnB_click:function(e){Player.btnB_set(Player.obj.currentTime)},btnB_set:function(e){Player.labelB_set(e),Player.is_labelA_show&&(checkAB(),Player.playAB())},labelB_set:function(e){Player.dotB=e;var t=Player.labelB_x=e/Player.obj.duration*Player.sliderWidth();$("#lblB").css("left",t+10),Player.lblB_show()},btnC_click:function(){Player.lbl_hide(),Player.is_R&&Player.cancelAB()},lblA_show:function(){$("#lblA").css("display","block"),this.is_labelA_show=!0},lblA_hide:function(){$("#lblA").css("display","none"),this.is_labelA_show=!1},lblB_show:function(){$("#lblB").css("display","block"),this.is_labelB_show=!0},lblB_hide:function(){$("#lblB").css("display","none"),this.is_labelB_show=!1},lbl_show:function(){this.lblA_show(),this.lblB_show()},lbl_hide:function(){this.lblA_hide(),this.lblB_hide()},bindBtns:function(){function e(t){t.preventDefault();var n=t.target;$(n).css("border","3px solid "+Player.btnBorderColor),$(n).off("mouseup mouseleave touchend",e),$(this).blur()}function t(e){var t,n=!1;e.on("mousedown touchstart",(function(){t=setTimeout((function(){n=!0,e.trigger("longpress")}),1e3),e.on("mouseup touchend",(function(r){r.preventDefault(),clearTimeout(t),n||e.trigger("shortpress",r),n=!1,e.off("mouseup touchend mouseout")})),e.on("mouseout",(function(){clearTimeout(t),n=!1,e.off("mouseup touchend mouseout")}))}))}function n(e,t){e.on("mousedown touchstart",(function(n){n.preventDefault();var r,l=!1;"A"==t&&(l=!0),l?(Player.is_btnA_down=!0,Player.dotA_old=Player.dotA,Player.dotA_wy=0):(Player.is_btnB_down=!0,Player.dotB_old=Player.dotB,Player.dotB_wy=0),"touchstart"==n.type&&(n=n.touches[0]),r={x:n.pageX,y:n.pageY},$(document).on("mousemove touchmove",(function(e){e.preventDefault(),l?(Player.is_btnA_moving=!0,Player.is_btnA_down&&getAB(e,r,!0)):(Player.is_btnB_moving=!0,Player.is_btnB_down&&getAB(e,r,!1))})),$(document).on("mouseup touchend",(function(t){$(document).off("mousemove touchmove mouseup touchend"),l?(Player.dotA_wy<6&&Player.btnA_click(t),Player.is_btnA_down=!1,Player.is_btnA_moving=!1,Player.dotA_old=Player.dotA,e.text("")):(Player.dotB_wy<6&&Player.btnB_click(t),Player.is_btnB_down=!1,Player.is_btnB_moving=!1,Player.dotB_old=Player.dotB,e.text("")),checkAB()})),this.blur()}))}$("#btns button").on("mousedown touchstart",(function(t){t.preventDefault();var n=t.target;$(n).css("border","3px solid #999"),$(n).on("mouseup mouseleave touchend",e)})),$("#btnPlay").on("click touchend",(function(e){e.preventDefault(),Player.btnPlay_click(e),this.blur()})),$("#btnStop").on("click touchend",(function(e){e.preventDefault(),Player.btnStop_click(e),this.blur()})),t($("#btnBf")),t($("#btnFf")),$("#btnBf").on("shortpress",(function(e,t){console.log("event: shortpress BF1",e.type),console.log("event: shortpress BF2",t.type),Player.btnBf_click(t)})),$("#btnBf").on("longpress",(function(){Player.btnBf_longclick()})),$("#btnFf").on("shortpress",(function(e,t){Player.btnFf_click(t)})),$("#btnFf").on("longpress",(function(){Player.btnFf_longclick()})),$("#btnX").on("mousedown touchstart",(function(e){var t;e.preventDefault(),Player.is_X_moving=!0,"touchstart"==e.type&&(e=e.touches[0]),t={x:e.pageX,y:e.pageY},$(document).on("mousemove touchmove",(function(e){e.preventDefault(),Player.is_X_moving&&getX(e,t)})),$(document).on("mouseup touchend",(function(e){e.preventDefault(),$(document).off("mousemove touchmove mouseup touchend"),Player.is_X_moving=!1,Player.rate=Player.rate0=Player.obj.playbackRate})),this.blur()})),$("#btnX").on("click touchend",(function(e){if("click"==e.type);else if("touchend"==e.type){e=e.changedTouches[0];$(this).offset();if(!isInElem(this,{x:e.clientX,y:e.clientY}))return}$("#btnX").text("1.0"),Player.rate=1,Player.obj.playbackRate=1,this.blur(),$("#btns").focus()})),$("#btnP").on("mousedown touchstart",(function(e){var t;e.preventDefault(),Player.is_btnP_down=!0,"touchstart"==e.type&&(e=e.touches[0]),t={x:e.pageX,y:e.pageY},$(document).on("mousemove touchmove",(function(e){e.preventDefault(),Player.is_btnP_down&&getP(e,t)})),$(document).on("mouseup touchend",(function(e){e.preventDefault(),$(document).off("mousemove touchmove mouseup touchend"),Player.is_btnP_moving?Player.R_time_wait=Player.R_time_wait_drag:Player.btnP_click(),Player.is_btnP_down=!1,Player.is_btnP_moving=!1})),this.blur()})),$("#btnR").on("mousedown touchstart",(function(e){var t;e.preventDefault(),Player.is_btnR_down=!0,"touchstart"==e.type&&(e=e.touches[0]),t={x:e.pageX,y:e.pageY},$(document).on("mousemove touchmove",(function(e){e.preventDefault(),Player.is_btnR_down&&getR(e,t)})),$(document).on("mouseup touchend",(function(e){e.preventDefault(),$(document).off("mousemove touchmove mouseup touchend"),Player.is_btnR_moving||Player.btnR_click(),Player.is_btnR_down=!1,Player.is_btnR_moving=!1,Player.r_cnt0=Player.r_cnt})),this.blur()})),n($("#btnA"),"A"),n($("#btnB"),""),$("#btnC").on("mousedown touchend",(function(e){Player.btnC_click()})),$("#btn-audio").on("click touchend",(function(e){e.preventDefault(),Player.stop(),Player.obj=Player.obja,bindDisp(),$("#vp").css("display","none"),Player.dispSrc(progfilename+".mp3"),lrc&&($("#btnsTC").show(),$("#txtWin").hide(),$("#lrcWin").show(),nowShow="lrc"),this.blur()})),$("#btn-video").on("click touchend",(function(e){e.preventDefault(),Player.stop(),Player.obj=Player.objv,bindDisp(),$("#vp").css("display","block"),Player.dispSrc(progfilename+".mp4"),$("#uc2").hide(),$("#txtWin").show(),this.blur()}))},bindEvents:function(){$("#ap, #vp").on("play",(function(){})),$("#ap, #vp").on("ended",(function(){2==Player.state2||Player.is_slider_dragging||(Player.obj.currentTime=0,Player.play())})),$("#ap, #vp").on("play",(function(){Player.play(0),Player.state2=1})),$("#ap, #vp").on("pause",(function(){Player.pause(0)}))},sliderWidth:function(){return $("#slider-frame").width()},dispMS:function(){$("#timebox").text(Player.currentMSstring())},dispSrc:function(e){$("#srcname").html('<a href="'+e+'" title="鍙抽敭鍙﹀瓨涓嬭浇锛岀Щ鍔ㄨ澶囬暱鎸変笅杞�">'+e+"</a>")},NtoMSstring:function(e){var t=parseInt(e/60),n=(e%60).toFixed();return(t=t<10?"0"+t:t)+":"+(n=n<10?"0"+n:n)},currentMSstring:function(){return this.NtoMSstring(this.obj.currentTime)+" / "+this.NtoMSstring(this.obj.duration)},rgb2hex:function(e){function t(e){return("0"+parseInt(e).toString(16)).slice(-2)}return"#"+t((e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))[1])+t(e[2])+t(e[3])},playersize:function(){"mp4"==Player.play_list[Player.current_index].substr(-3)?Player.videosize():Player.audiosize()},audiosize:function(){$("#vp").css("display","none")},videosize:function(){$("#vp").css("display","block")},init:function(){this.obja=document.getElementById("ap"),this.objv=document.getElementById("vp"),detectTouch()&&(this.is_touch=!0),this.btnBorderColor=this.rgb2hex($("#btns button").css("borderTopColor")),this.ch()}};function getX(e,t){"touchmove"==e.type&&(e=e.touches[0]);var n,r=e.pageX-t.x,l=t.y-e.pageY;n=myabs(r)>=myabs(l)?r:l,n=parseInt(n/25),(n=Player.rate+n/10)>Player.ratemax?n=Player.ratemax:n<Player.ratemin&&(n=Player.ratemin),n=n.toFixed(1),Player.obj.playbackRate=parseFloat(n),$("#btnX").text(n)}function myabs(e){return e>0?e:-e}function getP(e,t){"touchmove"==e.type&&(e=e.touches[0]);var n,r=e.pageX-t.x,l=t.y-e.pageY;n=myabs(r)>=myabs(l)?r:l,Player.is_btnP_moving=(n>0?n:-n)>10,n=parseInt(n/20),(n=Player.R_time_wait/1e3+n)>99?n=99:n<0&&(n=0),$("#btnP").text(n>0?n:""),Player.R_time_wait_drag=1e3*n}function getR(e,t){"touchmove"==e.type&&(e=e.touches[0]);var n,r=e.pageX-t.x,l=t.y-e.pageY;n=myabs(r)>=myabs(l)?r:l,Player.is_btnR_moving=(n>0?n:-n)>10,n=parseInt(n/20),(n=Player.r_cnt0+n)>99?n=99:n<0&&(n=0),n?Player.is_R||is_R_tc?$("#btnR").text(Player.r_cnt_now+1+"/"+n):$("#btnR").text(n):$("#btnR").text(""),Player.r_cnt=n}function getAB(e,t,n){"touchmove"==e.type&&(e=e.touches[0]);var r,l=e.pageX-t.x,o=t.y-e.pageY;if(r=myabs(l)>=myabs(o)?l:o,n?Player.dotA_wy=r>=0?r:-r:Player.dotB_wy=r>=0?r:-r,r=parseInt(r/25),n?Player.dotA=Player.dotA_old+r:Player.dotB=Player.dotB_old+r,n){if(Player.dotA<0?Player.dotA=0:Player.dotA>Player.obj.duration&&(Player.dotA=Player.obj.duration),Player.labelA_x=Player.dotA/Player.obj.duration*Player.sliderWidth(),!Player.is_labelA_show)return;$("#lblA").css({left:Player.labelA_x}),$("#btnA").text(r)}else{if(Player.dotB<0?Player.dotB=0:Player.dotB>Player.obj.duration&&(Player.dotB=Player.obj.duration),Player.labelB_x=Player.dotB/Player.obj.duration*Player.sliderWidth(),!Player.is_labelB_show)return;$("#lblB").css({left:Player.labelB_x+10}),$("#btnB").text(r)}}function checkAB(){if(Player.is_labelA_show&&Player.is_labelB_show&&Player.labelA_x>Player.labelB_x){var e=Player.labelA_x;Player.labelA_x=Player.labelB_x,Player.labelB_x=e,e=Player.dotA,Player.dotA=Player.dotB,Player.dotB=e,$("#lblA").css({left:Player.labelA_x,display:"block"}),$("#lblB").css({left:Player.labelB_x+10,display:"block"})}}function bindSlider(){$(Player.obj)[0];$("#slider").mousedown((function(e){e.preventDefault(),Player.is_touch||(Player.is_slider_dragging=!0,gotoE(e),$("#playerwrap").on("mousemove",(function(e){e.preventDefault(),Player.is_touch||Player.is_slider_dragging&&gotoE(e)})))})),$("#playerwrap").on("mouseup mouseleave",(function(e){Player.is_touch||($("#playerwrap").off("mousemove"),Player.is_slider_dragging=!1)})),$("#slider").on("touchstart",(function(e){e.preventDefault(),Player.is_slider_dragging=!0,gotoETouch(e)})),$("#slider").on("touchmove",(function(e){e.preventDefault(),Player.is_slider_dragging=!0,gotoETouch(e)})),$("#slider").on("touchend",(function(e){e.preventDefault(),Player.is_slider_dragging=!1,gotoETouch(e)}))}function gotoE(e){var t=e.pageX-$("#slider-frame").offset().left;Player.obj.currentTime=Player.obj.duration*t/Player.sliderWidth()}function gotoETouch(e){var t;t=("touchend"==e.type?e.changedTouches[0]:e.touches[0]).pageX-$("#slider-frame").offset().left,Player.obj.currentTime=Player.obj.duration*t/Player.sliderWidth()}function InstallHtmlFuncKeys(){document.onkeydown=function(e){var t=e||window.event,n=t.keyCode;if(n>=112&&n<=123){switch(_keycode=n,n){case keycode_F1:F1();break;case keycode_F2:F2();break;case keycode_F3:F3();break;case keycode_F4:F4();break;case keycode_F5:return;case keycode_F6:F6();break;case keycode_F7:F7();break;case keycode_F8:F8();break;case keycode_F9:F9();break;case keycode_F10:F10();break;case keycode_F11:F11();break;case keycode_F12:F12()}return t.returnValue=!1,t.preventDefault(),t.stopPropagation(),!1}}}function F5(){}function F7(){Player.btnStop_click()}function F8(){Player.btnPlay_click()}function F9(){Player.btnR_click()}function F10(){}function F11(){}function F12(){}function disp(e){var t=document.getElementById("disp").innerText;t=t+" | "+e,document.getElementById("disp").innerText=t}function displist(){var e=Player.play_list.join("|");e=e+"||"+Player.obj.src,$("#disp-list").html(e)}function dispState(){$("#readystate").text("鐘舵€�:"+Player.obj.readyState+", 闀垮害:"+Player.obj.duration+", 鏆傚仠鍚�:"+Player.obj.paused+", state="+Player.state+", ended="+Player.obj.ended+", Player.rate="+Player.rate+", obj.rate="+Player.obj.playbackRate)}function isInElem(e,t){$o=$(e);var n=$o.offset().left,r=$o.offset().top,l=$o.outerWidth(),o=$o.outerHeight();return n-=$(document).scrollLeft(),r-=$(document).scrollTop(),t.x>=n&&t.x<=n+l&&t.y>=r&&t.y<=r+o}function touch(e){(e||window.event).touches[0]}function getxy(e){return"clientXY: "+e.clientX.toFixed()+", "+e.clientY.toFixed()+"\npageXY: "+e.pageX.toFixed()+", "+e.pageY.toFixed()+"\nscreenXY:"+e.screenX.toFixed()+", "+e.screenY.toFixed()}function detectTouch(){return!!navigator.userAgent.match(/(iPhone|iPad|iPod|Android|ios|Symbian|mobile|ubweb|windows ce)/i)}function bindothers(){function e(e){e?($("#txt").show(),$("#btn-txt").css("background-image","url(/webr8/img/txt.png)"),is_txt_show=!0):($("#txt").hide(),$("#btn-txt").css("background-image","url(/webr8/img/txtno.png)"),is_txt_show=!1)}function t(e){e?($("#lrc").show(),$("#btn-lrc").css("background-image","url(/webr8/img/lrc.png)"),is_lrc_show=!0):($("#lrc").hide(),$("#btn-lrc").css("background-image","url(/webr8/img/lrcno.png)"),is_lrc_show=!1)}var n,r,l;document.getElementById("btn-usage").onclick=function(e){$("#btnsTC").is(":visible")?$("#uc2").show():$("#uc2").hide(),$("#usagecontent").slideToggle()},document.getElementById("btn-edit").onclick=function(e){$("#editWin").is(":hidden")?($("#editWin").show(),is_editWin_show=!0):($("#editWin").hide(),is_editWin_show=!1)},document.getElementById("btn-src").onclick=function(e){$("#srcWin").is(":hidden")?($("#srcWin").show(),$("#btn-src").css("background-image","url(/webr8/img/srcshow.png)"),is_editSrc_show=!0):($("#srcWin").hide(),$("#btn-src").css("background-image","url(/webr8/img/srchide.png)"),is_editSrc_show=!1)},$("#tablrc").click((function(){$("#tablrc").is(".tabshow")||($("#tablrc").addClass("tabshow"),$("#tabtxt").removeClass("tabshow"),$("#lrc").show(),$("#txt").hide())})),$("#tabtxt").click((function(){$("#tabtxt").is(".tabshow")||($("#tabtxt").addClass("tabshow"),$("#tablrc").removeClass("tabshow"),$("#txt").show(),$("#lrc").hide())})),0!=$("#btn-txt").length&&(document.getElementById("btn-txt").onclick=function(n){$("#txt").is(":visible")?(e(!1),t(!0)):(e(!0),t(!1))}),0!=$("#btn-lrc").length&&(document.getElementById("btn-lrc").onclick=function(e){$("#lrc").is(":visible"),$("#btn-txt").click()}),$("#srcWinBarFull").click((function(){$("#tablrc").is(".tabshow")?$("#lrc").css({height:"auto",overflowY:"visible"}):$("#txt").css({height:"auto",overflowY:"visible"})})),$("#srcWinBarPart").click((function(){$("#tablrc").is(".tabshow")?$("#lrc").css({height:"300px",overflowY:"scroll"}):$("#txt").css({height:"300px",overflowY:"scroll"})})),r=!1,(l=document.getElementById("vp")).onclick=function(e){e.preventDefault(),clearTimeout(n),n=setTimeout((function(){Player.btnPlay_click()}),300)},l.ondblclick=function(e){e=e||window.event,window.event?e.cancelBubble=!0:e.stopPropagation(),e.preventDefault(),clearTimeout(n),r?(document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),r=!1):(function(e){e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()}(l),r=!0),console.log("dbl click")}}function fontSize(e,t,n){var r,l;e=e||window.event;(r=0==t?$("#editWinText"):$("#tablrc").is(".tabshow")?$("#lrc li"):$("#txt li"),e.ctrlKey)?r.css("font-size","16px"):(l=parseInt(r.css("font-size")),-1==n?12!=l&&r.css("font-size",l-2+"px"):1==n&&24!=l&&r.css("font-size",l+2+"px"))}function send(){var e=document.getElementById("editWinForm").editWinText.value.trim();""!=e?e.length>1e5?alert("浜诧細鎮ㄥ啓寰楀お澶氫簡锛屾垜淇濆瓨涓嶄笅锛乗n\nText Length Cannot Access 100K !"):document.getElementById("editWinForm").submit():alert("娌℃湁鍐呭锛屾棤娉曚繚瀛橈紒\n\nNothing to Save!")}function basename(e){var t=e.lastIndexOf("/");return-1==t?e:e.substr(t+1)}function filefirstname(e){var t=e.lastIndexOf(".");return-1==t?e:e.substr(0,t)}function filelastname(e){var t=e.lastIndexOf(".");return-1==t?e:e.substr(t+1)}function yellowline(e){$("#lrc li").css("background-color",""),$("#lrc div").eq(e).children("li").css("background-color","#ffee44")}function btnTC_on(e,t){e.css("background-color",t?"#ffee00":"")}function btnTC_off(){btnTC_on($("#btnTCRline"),!1),btnTC_on($("#btnTCRlines"),!1),btnTC_on($("#btnTCXRline"),!1),btnTC_on($("#btnTCXRlines"),!1)}function clearTCTimer(e){clearInterval(playtcTimer),is_R_tc=!1,Player.r_cnt_now=0,btnTC_off(),e&&(Player.rate=Player.rate0,Player.setPlayerRate(Player.rate),$("#btnR").text(Player.r_cnt0?Player.r_cnt0:""))}function playTCline(e){is_R_tc=!0,tcMode=0,tcIndex=e,tcFrom=tc[e],tcTo=e<tcLength-1?tc[e+1]:Player.obj.duration,Player.obj.currentTime=tcFrom,Player.play(),Player.obj.playbackRate=Player.rate,clearTCTimer(),playtcTimer=setInterval((function(){Player.obj.currentTime>tcTo-.1&&(Player.pause(),clearTCTimer(),Player.obj.currentTime=tcFrom,is_R_tc=!1)}),20)}function playTCRline(e){tcMode=1,tcIndex=e,tcFrom=tc[e],tcTo=e<tcLength-1?tc[e+1]:Player.obj.duration,Player.obj.currentTime=tcFrom,Player.play(),Player.obj.playbackRate=Player.rate,clearTCTimer(),btnTC_on($("#btnTCRline"),!0),is_R_tc=!0,Player.r_cnt_now=0,disped=!1,playtcTimer=setInterval((function(){Player.r_cnt0&&!disped&&($("#btnR").text(Player.r_cnt_now+1+"/"+Player.r_cnt0),disped=!0),Player.obj.currentTime>tcTo-.1&&(Player.pause(),Player.obj.currentTime=tcFrom,Player.r_cnt0&&++Player.r_cnt_now>=Player.r_cnt0?(clearTCTimer(!0),is_R_tc=!1):(disped=!1,timer_R_tc=setTimeout((function(){Player.play()}),Player.R_time_wait)))}),20)}function playTCRlines(){tcMode=2,i=tcIndex,tcFrom=tc[tcIndex],tcTo=i<tcLength-1?tc[i+1]:Player.obj.duration,Player.obj.currentTime=tcFrom,Player.play(),Player.obj.playbackRate=Player.rate,clearTCTimer(!1),btnTC_on($("#btnTCRlines"),!0),is_R_tc=!0,Player.r_cnt_now=0,disped=!1,playtcTimer=setInterval((function(){cntR_tc=0==Player.r_cnt0?3:Player.r_cnt0,disped||($("#btnR").text(Player.r_cnt_now+1+"/"+cntR_tc),disped=!0),Player.obj.currentTime>tcTo-.1&&(Player.pause(),Player.obj.currentTime=tcFrom,++Player.r_cnt_now>=cntR_tc?(clearTCTimer(!1),tcIndex==tcLength-1?tcIndex=0:tcIndex++,$("#btnR").text(cntR_tc),playTCRlines(tcIndex)):disped=!1,timer_R_tc=setTimeout((function(){Player.play()}),Player.R_time_wait))}),20)}function playTCXRline(e){tcMode=3,tcIndex=e,tcFrom=tc[e],tcTo=e<tcLength-1?tc[e+1]:Player.obj.duration,Player.obj.currentTime=tcFrom,Player.play(),Player.obj.playbackRate=1,Player.setPlayerRate(1),clearTCTimer(!1),btnTC_on($("#btnTCXRline"),!0),is_R_tc=!0,Player.r_cnt_now=1,disped=!1,playtcTimer=setInterval((function(){Player.r_cnt0&&!disped&&($("#btnR").text(Player.r_cnt_now+"/"+Player.r_cnt0),disped=!0),Player.obj.currentTime>tcTo-.1&&(Player.pause(),Player.obj.currentTime=tcFrom,Player.r_cnt0&&Player.r_cnt_now>=Player.r_cnt0?clearTCTimer(!0):(Player.r_cnt_now%3==1?Player.setPlayerRate(.7):Player.r_cnt_now%3==2?Player.setPlayerRate(1.5):Player.r_cnt_now%3==0&&Player.setPlayerRate(1),disped=!1,timer_R_tc=setTimeout((function(){Player.play()}),Player.R_time_wait)),Player.r_cnt_now++)}),20)}function playTCXRlines(){tcMode=4,i=tcIndex,tcFrom=tc[tcIndex],tcTo=i<tcLength-1?tc[i+1]:Player.obj.duration,Player.obj.currentTime=tcFrom,Player.play(),Player.obj.playbackRate=1,Player.setPlayerRate(1),clearTCTimer(!1),btnTC_on($("#btnTCXRlines"),!0),is_R_tc=!0,Player.r_cnt_now=0,disped=!1,playtcTimer=setInterval((function(){cntR_tc=0==Player.r_cnt0?3:Player.r_cnt0,disped||($("#btnR").text(Player.r_cnt_now+1+"/"+cntR_tc),disped=!0),Player.obj.currentTime>tcTo-.1&&(Player.pause(),Player.obj.currentTime=tcFrom,++Player.r_cnt_now>=cntR_tc?(clearTCTimer(!1),$("#btnR").text(""),tcIndex==tcLength-1?tcIndex=0:tcIndex++,playTCXRlines(tcIndex)):(Player.r_cnt_now%3==1?Player.setPlayerRate(.7):Player.r_cnt_now%3==2?Player.setPlayerRate(1.5):Player.r_cnt_now%3==0&&Player.setPlayerRate(1),disped=!1,timer_R_tc=setTimeout((function(){Player.play()}),Player.R_time_wait)))}),20)}function bindDisp(){$(Player.obj).on("timeupdate",(function(e){var t=this.currentTime/this.duration*Player.sliderWidth();if($("#slider-play").width(t),Player.dispMS(),lrc&&"txt"!=nowShow){for(var n=this.currentTime.toFixed(2),r=0;r<tcLength&&!(tc[r]>n);r++);(tcIndex=r-1)<0&&(tcIndex=0),yellowline(tcIndex);var l=$("#lrc div:eq("+tcIndex+")").position().top,o=$("#lrc").scrollTop();(l>250||l<10)&&$("#lrc").scrollTop(o+l-40)}})),$(Player.obj).on("loadeddata",(function(e){Player.dispMS(),Player.dispSrc(srcNow)}))}function putlrc(e){loadLrc2Page(e.split("\r\n"))}function loadLrc2Page(e){for(var t,n,r=[],l="",o=0,a=0;a<e.length;a++)if(""!=e[a].trim()&&/\[\d\d:\d\d\.\d\d\]/.test(e[a])){var c=e[a].indexOf("]");t=e[a].substr(1,c-1),n=e[a].substr(c+1);var i=s2n(t);r.push(parseFloat(i)),l+="<div><span>"+ ++o+"</span><li>"+n+"</li></div>"}clearTCTimer(),$("#btnsTC").show(),nowShow="lrc",$("#lrc").html(l).show(),$("#txt").hide(),tc=r,tcLength=tc.length,lrc=" ",b(),bindDisp()}function s2n(e){return n=e.split(":"),n=60*parseInt(n[0])+parseFloat(n[1])+delaySec,n.toFixed(2)}function b(){tcLength=tc.length,bindDisp(),detectTouch()&&($("#txt, #lrc").addClass("txt-touch1"),$("#txt li, #lrc li").addClass("txt-touch2")),$("#lrc li").click((function(){playTCline($(this).parent().index())})),$("#lrc li").dblclick((function(){})),$("#btnTCPlay").click((function(){playTCline(tcIndex)})),$("#btnTCStop").click((function(){$("#btnStop").click(),clearTCTimer(),Player.obj.currentTime=tc[tcIndex],Player.pause(),Player.r_cnt0&&$("#btnR").text(Player.r_cnt0)})),$("#btnTCBf").click((function(){tcIndex>0&&tcIndex--,tcFrom=tc[tcIndex],tcTo=tc[tcIndex+1],tcR_cntNow=0,Player.obj.currentTime=tcFrom,Player.obj.playbackRate=Player.rate})),$("#btnTCFf").click((function(){tcIndex<tcLength-1&&tcIndex++,tcFrom=tc[tcIndex],tcTo=tcIndex<tcLength-1?tc[tcIndex+1]:Player.obj.duration,tcR_cntNow=0,Player.obj.currentTime=tcFrom,Player.obj.playbackRate=Player.rate})),$("#btnTCRline").click((function(){playTCRline(tcIndex)})),$("#btnTCRlines").click((function(){playTCRlines()})),$("#btnTCXRline").click((function(){playTCXRline(tcIndex)})),$("#btnTCXRlines").click((function(){playTCXRlines()}))}$((function(){Player.init();document.getElementById("slider-frame");bindSlider(),Player.bindBtns(),Player.bindEvents(),InstallHtmlFuncKeys(),bindothers()})),$(window).scroll((function(){var e=$(window),t=$("#playerblock"),n=$("#playerwrap"),r=e.scrollTop();r>t.offset().top?n.addClass("stick0"):n.removeClass("stick0");var l=$("#srcWinBarBlock"),o=$("#srcWinBar"),a=l.offset().top,c=$("#playerblock").outerHeight();r>a-c?(o.addClass("stick1"),o.css("top",c)):o.removeClass("stick1")})),$(window).resize((function(){$(window).width()})),String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")},String.prototype.ltrim=function(){return this.replace(/(^\s*)/g,"")},String.prototype.rtrim=function(){return this.replace(/(\s*$)/g,"")},$((function(){tcLength=tc.length,mp3&&(Player.obja.src=progfilename+".mp3"),mp4&&(Player.objv.src=progfilename+".mp4"),vf&&mp4||!mp3&&mp4?(Player.obj=Player.objv,srcNow=progfilename+".mp4",$("#ap").hide(),$("#vp").show(),nowShow="lrc"):(Player.obj=Player.obja,srcNow=progfilename+".mp3"),lrc?$("#txt").hide():$("#txt").show(),bindDisp(),Player.is_touch&&($("#txt, #lrc").css({"padding-left":"8px","padding-right":"8px"}),$("#txt span, #lrc span").css({"padding-top":"5px"}),$("#txt li, #lrc li").css({"font-size":"18px"})),$("#lrc li").click((function(){playTCline($(this).parent().index())})),$("#lrc li").dblclick((function(){})),$("#btnTCPlay").click((function(){playTCline(tcIndex)})),$("#btnTCStop").click((function(){$("#btnStop").click(),Player.obj.currentTime=tc[tcIndex],Player.pause(),$("#btnR").text(Player.r_cnt0?Player.r_cnt0:"")})),$("#btnTCBf").click((function(){tcIndex>0&&tcIndex--,tcFrom=tc[tcIndex],tcTo=tc[tcIndex+1],Player.r_cnt_now=0,Player.obj.currentTime=tcFrom,Player.obj.playbackRate=Player.rate})),$("#btnTCFf").click((function(){tcIndex<tcLength-1&&tcIndex++,tcFrom=tc[tcIndex],tcTo=tcIndex<tcLength-1?tc[tcIndex+1]:Player.obj.duration,Player.r_cnt_now=0,Player.obj.currentTime=tcFrom,Player.obj.playbackRate=Player.rate})),$("#btnTCRline").click((function(){playTCRline(tcIndex)})),$("#btnTCRlines").click((function(){playTCRlines()})),$("#btnTCXRline").click((function(){playTCXRline(tcIndex)})),$("#btnTCXRlines").click((function(){playTCXRlines()}))})),$("#disp1").click((function(){$(this).text(playtcTimer)}));
